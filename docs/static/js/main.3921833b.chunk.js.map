{"version":3,"sources":["../../workgrid-javascript/packages/workgrid-micro-app/dist sync","../../workgrid-javascript/packages/workgrid-courier/dist sync","../../workgrid-javascript/packages/workgrid-micro-app/dist/queue.js","../../workgrid-javascript/packages/workgrid-courier/dist/courier.js","../../workgrid-javascript/packages/workgrid-courier/dist/emitter.js","components/Tests.js","pages/Summary.js","pages/IFrameDetail.js","pages/TestDetail.js","App.js","index.js","../../workgrid-javascript/packages/workgrid-micro-app/dist/micro-app.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","v","factory","undefined","require","__esModule","queue","push","fn","flushed","flush","map","tslib_1","emitter_1","__importDefault","nice_try_1","debug_1","v4_1","ms_1","lodash_1","logger","is","object","type","Object","prototype","toString","call","Courier","_a","_this","this","_b","timeout","sources","hosts","setup","debug","forEach","host","addEventListener","handleMessage","teardown","removeEventListener","register","source","contentWindow","includes","unregister","splice","indexOf","on","handler","emitter","off","emit","payload","target","message","sendMessage","send","event","data","Promise","reject","timeoutId","setTimeout","internal","error","clearTimeout","transfer","global","channel_1","MessageChannel","port1","onmessage","channel","port2","args","_i","arguments","length","assign","apply","__spread","isMessagePort","postMessage","JSON","stringify","nativeEvent","parse","parentId","invoke","__awaiter","e_1","__generator","label","trys","sent","ports","extend","window","parent","listeners","create","remove","value","callback","testTypes","microapp","useState","testType","name","result","tests","setTests","testActions","useRef","useEffect","testToken","current","Token","Title","testTitle","Show","testShow","Hide","testHide","updateTest","update","prevTests","test","a","getToken","token","process","decodedToken","decode","aud","console","warn","updateTitle","Math","floor","random","showDetail","url","location","origin","pathname","hideDetail","className","key","aria-label","role","onClick","testName","Summary","MicroApp","audience","log","initialize","detailPage","title","placeholder","Tests","Detail","currentCount","setCurrentCount","iframeUrl","setIframeUrl","countdownTimer","setInterval","prev","clearInterval","style","width","borderWidth","src","App","basename","path","exact","component","TestDetail","IFrameDetail","ReactDOM","render","document","getElementById","queue_1","courier_1","jwt_decode_1","resize_observer_polyfill_1","p_any_1","EVENTS","READY","ERROR","SET_SIZE","SHOW_DETAIL","HIDE_DETAIL","UPDATE_TITLE","REFRESH_TOKEN","READY_TIMEOUT","READY_INTERVAL","isExpired","exp","Date","now","onError","ready","then","subscribe","ro","observe","documentElement","unsubscribe","disconnect","handleResize","throttle","entries","height","offsetHeight","courier","attempt","sendPromises","interval"],"mappings":"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","file":"static/js/main.3921833b.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 240;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 242;","(function (factory) {\n  if (typeof module === \"object\" && typeof module.exports === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  exports.__esModule = true;\n\n  exports[\"default\"] = function () {\n    var queue = [];\n    return {\n      queue: queue,\n      push: function push(fn) {\n        if (queue.flushed) fn();else queue.push(fn);\n      },\n      flush: function flush() {\n        queue.flushed = true;\n        queue.map(function (fn) {\n          return fn();\n        });\n      }\n    };\n  };\n});","(function (factory) {\n  if (typeof module === \"object\" && typeof module.exports === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"tslib\", \"./emitter\", \"nice-try\", \"debug/dist/debug\", \"uuid/v4\", \"ms\", \"lodash\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  exports.__esModule = true;\n\n  var tslib_1 = require(\"tslib\");\n\n  var emitter_1 = tslib_1.__importDefault(require(\"./emitter\"));\n\n  var nice_try_1 = tslib_1.__importDefault(require(\"nice-try\"));\n\n  var debug_1 = tslib_1.__importDefault(require(\"debug/dist/debug\"));\n\n  var v4_1 = tslib_1.__importDefault(require(\"uuid/v4\"));\n\n  var ms_1 = tslib_1.__importDefault(require(\"ms\"));\n\n  var lodash_1 = require(\"lodash\");\n\n  var logger = debug_1[\"default\"]('courier'); // default logger namespace\n\n  var is = function is(object, type) {\n    return Object.prototype.toString.call(object) === \"[object \" + type + \"]\";\n  };\n  /**\n   * Create a new instance of Courier (the Workgrid messenger).\n   *\n   * @beta\n   */\n\n\n  var Courier =\n  /** @class */\n  function () {\n    function Courier(_a) {\n      var _this = this;\n\n      var _b = _a === void 0 ? {} : _a,\n          timeout = _b.timeout,\n          sources = _b.sources,\n          hosts = _b.hosts,\n          id = _b.id;\n      /**\n       * Set up the host message listeners.\n       */\n\n\n      this.setup = function () {\n        _this.debug('setup', {});\n\n        _this.hosts.forEach(function (host) {\n          host.addEventListener('message', _this.handleMessage);\n        });\n      };\n      /**\n       * Tear down the host message listeners.\n       */\n\n\n      this.teardown = function () {\n        _this.debug('teardown', {});\n\n        _this.hosts.forEach(function (host) {\n          host.removeEventListener('message', _this.handleMessage);\n        });\n      };\n      /**\n       * Add a message source.\n       */\n\n\n      this.register = function (source) {\n        _this.debug('register', {\n          source: source\n        });\n\n        if (!source) return; // if (!is(source, 'Window')) source = source.contentWindow\n\n        source = nice_try_1[\"default\"](function () {\n          return source.contentWindow;\n        }) || source;\n        if (!lodash_1.includes(_this.sources, source)) _this.sources.push(source);\n      };\n      /**\n       * Remove a message source.\n       */\n\n\n      this.unregister = function (source) {\n        _this.debug('unregister', {\n          source: source\n        });\n\n        if (!source) return; // if (!is(source, 'Window')) source = source.contentWindow\n\n        source = nice_try_1[\"default\"](function () {\n          return source.contentWindow;\n        }) || source;\n\n        _this.sources.splice(_this.sources.indexOf(source) >>> 0, 1);\n      };\n      /**\n       * Start listening for an event.\n       */\n\n\n      this.on = function (type, handler) {\n        _this.debug('on', {\n          type: type,\n          handler: handler\n        });\n\n        _this.emitter.on(type, handler);\n      };\n      /**\n       * Stop listening for an event.\n       */\n\n\n      this.off = function (type, handler) {\n        _this.debug('off', {\n          type: type,\n          handler: handler\n        });\n\n        _this.emitter.off(type, handler);\n      };\n      /**\n       * Send a message (response ignored).\n       */\n\n\n      this.emit = function (_a) {\n        var type = _a.type,\n            payload = _a.payload,\n            target = _a.target;\n\n        _this.debug('emit', {\n          type: type,\n          payload: payload,\n          target: target\n        });\n\n        var message = {\n          type: type,\n          payload: payload\n        };\n\n        _this.sendMessage(message, target);\n      };\n      /**\n       * Send a message (response expected).\n       */\n\n\n      this.send = function (_a) {\n        var type = _a.type,\n            payload = _a.payload,\n            target = _a.target,\n            timeout = _a.timeout;\n\n        _this.debug('send', {\n          type: type,\n          payload: payload,\n          target: target,\n          timeout: timeout\n        });\n\n        var message = {\n          id: v4_1[\"default\"](),\n          type: type,\n          payload: payload\n        };\n        var event = {\n          data: message\n        }; // for errors\n\n        var promise = new Promise(function (resolve, reject) {\n          var timeoutId = setTimeout(function () {\n            _this.internal.off(message.id);\n\n            reject(_this.error('APP-14', {\n              event: event\n            }));\n          }, timeout || _this.timeout);\n\n          _this.internal.on(message.id, function (error, data) {\n            clearTimeout(timeoutId);\n\n            _this.internal.off(message.id);\n\n            if (!error) return resolve(data);\n            reject(_this.error('APP-16', {\n              event: event,\n              error: error,\n              data: data\n            }));\n          });\n\n          var transfer = [];\n\n          if ('MessageChannel' in global) {\n            var channel_1 = new MessageChannel();\n\n            channel_1.port1.onmessage = function (event) {\n              _this.debug('onmessage', {\n                event: event,\n                target: target,\n                channel: channel_1\n              }); // TODO: Passing a new instance of MessageEvent doesn't work in react-native :(\n              // this.handleMessage(new MessageEvent('message', { data: event.data, source: target }))\n\n\n              _this.handleMessage({\n                data: event.data,\n                source: target\n              });\n            };\n\n            transfer = [channel_1.port2];\n          }\n\n          _this.sendMessage(message, target, transfer);\n        });\n        return promise;\n      };\n      /**\n       * Create a new error object with the given arguments, and fire an internal error event.\n       */\n\n\n      this.error = function (code) {\n        var args = [];\n\n        for (var _i = 1; _i < arguments.length; _i++) {\n          args[_i - 1] = arguments[_i];\n        }\n\n        _this.debug('error', {\n          code: code,\n          args: args\n        });\n\n        var error = new Error(code);\n        lodash_1.assign.apply(void 0, tslib_1.__spread([error], args));\n\n        _this.emitter.emit('error', error);\n\n        return error;\n      };\n      /**\n       * Send a message to the given target, with the given data and trasferables.\n       * If the target supplied is not a registered source, an error will be thrown.\n       */\n\n\n      this.sendMessage = function (data, target, transfer) {\n        _this.debug('sendMessage', {\n          data: data,\n          target: target\n        });\n\n        target = target || _this.sources[0]; // We must nice-try this one for Edge\n\n        var isMessagePort = nice_try_1[\"default\"](function () {\n          return is(target, 'MessagePort');\n        }) || false;\n\n        if (!isMessagePort && !lodash_1.includes(_this.sources, target)) {\n          throw _this.error('APP-13', {\n            target: target\n          });\n        }\n\n        try {\n          if (isMessagePort) {\n            _this.debug('postMessage', {\n              target: target,\n              data: data\n            });\n\n            target.postMessage(JSON.stringify(data));\n          } else {\n            _this.debug('postMessage', {\n              target: target,\n              data: data,\n              transfer: transfer\n            });\n\n            target.postMessage(JSON.stringify(data), '*', transfer);\n          }\n        } catch (error) {\n          throw _this.error('APP-12', {\n            error: error,\n            target: target,\n            transfer: transfer\n          });\n        }\n      };\n      /**\n       * Process a message event and emit or invoke to the appropriate handlers.\n       * This method will be called when the registered hosts receive a message.\n       */\n\n\n      this.handleMessage = function (event) {\n        _this.debug('handleMessage', {\n          event: event\n        }); // event.source will be null in tests\n        // https://github.com/jsdom/jsdom/pull/1140\n\n\n        if (event.source && !lodash_1.includes(_this.sources, event.source)) {\n          // throw this.error('APP-15', { source: event.source })\n          return _this.error('APP-15', {\n            source: event.source\n          });\n        } // https://facebook.github.io/react-native/docs/webview#onmessage\n\n\n        var data = 'nativeEvent' in event ? event.nativeEvent.data : event.data;\n\n        try {\n          if (typeof data === 'string') data = JSON.parse(data);\n        } catch (error) {\n          // throw this.error('APP-11', { error })\n          return _this.error('APP-11', {\n            error: error\n          });\n        } // Response\n\n\n        if (data && data.parentId) {\n          _this.internal.emit(data.parentId, data.error, data.payload);\n\n          return;\n        } // Incoming\n\n\n        if (data && data.type) {\n          _this.emitter.invoke(data.type, function (handler) {\n            return tslib_1.__awaiter(_this, void 0, void 0, function () {\n              var payload, error, e_1, target;\n              return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                  case 0:\n                    _a.trys.push([0, 2,, 3]);\n\n                    return [4\n                    /*yield*/\n                    , handler({\n                      source: event.source,\n                      data: data\n                    })];\n\n                  case 1:\n                    // TODO: Passing a new instance of MessageEvent doesn't work in react-native :(\n                    // payload = await handler(new MessageEvent('message', { source: event.source, data }))\n                    payload = _a.sent();\n                    return [3\n                    /*break*/\n                    , 3];\n\n                  case 2:\n                    e_1 = _a.sent();\n                    error = e_1;\n                    return [3\n                    /*break*/\n                    , 3];\n\n                  case 3:\n                    if (!data.id) return [2\n                    /*return*/\n                    , this.debug('APP-17', {\n                      event: event,\n                      payload: payload,\n                      error: error\n                    })];\n                    target = event.ports && event.ports[0] || event.source;\n                    this.sendMessage({\n                      parentId: data.id,\n                      payload: payload,\n                      error: error\n                    }, target);\n                    return [2\n                    /*return*/\n                    ];\n                }\n              });\n            });\n          });\n\n          return;\n        } // throw this.error('APP-10', { event })\n\n\n        return _this.error('APP-10', {\n          event: event\n        });\n      };\n\n      this.debug = id ? logger.extend(id) : logger; // ¯\\_(ツ)_/¯\n\n      this.debug('constructor', {\n        timeout: timeout,\n        sources: sources,\n        hosts: hosts\n      });\n      this.timeout = timeout || ms_1[\"default\"]('10 seconds');\n      this.sources = sources || [global.window.parent];\n      this.hosts = hosts || [global.window];\n      this.internal = emitter_1[\"default\"]();\n      this.emitter = emitter_1[\"default\"]();\n      this.setup();\n    }\n\n    Courier.debug = debug_1[\"default\"]; // TODO: Replace with `logger` instance variable\n\n    return Courier;\n  }();\n\n  exports[\"default\"] = Courier;\n});","(function (factory) {\n  if (typeof module === \"object\" && typeof module.exports === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"tslib\", \"lodash\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  exports.__esModule = true;\n\n  var tslib_1 = require(\"tslib\");\n\n  var lodash_1 = require(\"lodash\");\n\n  exports[\"default\"] = function () {\n    var listeners = Object.create(null);\n    return {\n      listeners: listeners,\n      on: function on(type, handler) {\n        listeners[type] = listeners[type] || [];\n        listeners[type].push(handler);\n      },\n      off: function off(type, handler) {\n        if (!handler) delete listeners[type];else lodash_1.remove(listeners[type], function (value) {\n          return value === handler;\n        });\n      },\n      emit: function emit(type) {\n        var args = [];\n\n        for (var _i = 1; _i < arguments.length; _i++) {\n          args[_i - 1] = arguments[_i];\n        }\n\n        lodash_1.map(listeners[type], function (handler) {\n          return handler.apply(void 0, tslib_1.__spread(args));\n        });\n      },\n      invoke: function invoke(type, callback) {\n        lodash_1.map(listeners[type], function (handler) {\n          return callback(handler);\n        });\n      }\n    };\n  };\n});","import React, { useState, useEffect, useRef } from 'react'\nimport { decode } from 'jsonwebtoken'\n\nconst testTypes = ['Token', 'Title', 'Show', 'Hide']\n\nexport default ({ microapp }) => {\n  const [tests, setTests] = useState(testTypes.map(testType => ({ name: testType, result: false })))\n  const testActions = useRef({})\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => testToken(), [microapp])\n\n  useEffect(() => {\n    testActions.current.Token = testToken\n    testActions.current.Title = testTitle\n    testActions.current.Show = testShow\n    testActions.current.Hide = testHide\n  })\n\n  const runTest = testName => () => {\n    testActions.current[testName]()\n  }\n\n  const updateTest = (name, update) => {\n    setTests(prevTests => {\n      return prevTests.map(test => {\n        if (test.name === name) {\n          return { ...test, ...update }\n        } else {\n          return test\n        }\n      })\n    })\n  }\n\n  const testToken = () => {\n    if (!microapp) return\n\n    updateTest('Token', { result: false })\n    // Arbitrarily add a \"loading time\" other wise you are kind of \"did it work?\"\n    setTimeout(async () => {\n      const token = await microapp.getToken()\n      // This would be done on a server side, notice how I'm not verifying the token\n      const decodedToken = decode(token)\n      // TODO alter this verification when this app is upgraded to the more secure token\n      if (decodedToken.aud === process.env.REACT_APP_AUD) {\n        updateTest('Token', { result: true })\n      } else {\n        console.warn(`Invalid token: ${decodedToken.aud} !== ${process.env.REACT_APP_AUD}`)\n      }\n    }, 1000)\n  }\n\n  const testTitle = () => {\n    updateTest('Title', { result: false })\n    microapp.updateTitle(`Title Change: ${Math.floor(Math.random() * 500)}`)\n    updateTest('Title', { result: true })\n  }\n\n  const testShow = () => {\n    updateTest('Show', { result: false })\n    microapp.showDetail({ url: `${window.location.origin}${window.location.pathname}#/tests` })\n    updateTest('Show', { result: true })\n  }\n\n  const testHide = () => {\n    updateTest('Hide', { result: false })\n    microapp.hideDetail()\n    updateTest('Hide', { result: true })\n  }\n\n  return (\n    <>\n      <strong>Tests:</strong>\n      {tests.map(test => (\n        <div className=\"checklist\" key={test.name}>\n          {test.result ? (\n            <span aria-label=\"pass\" role=\"img\" className=\"pass\">\n              ✅\n            </span>\n          ) : (\n            <span aria-label=\"fail\" role=\"img\" className=\"pass\">\n              ❌\n            </span>\n          )}\n          <div className=\"item\">{test.name}</div>\n          <div className=\"item\">\n            <button className=\"action-small\" onClick={runTest(test.name)}>\n              Run\n            </button>\n          </div>\n        </div>\n      ))}\n    </>\n  )\n}\n","import React, { useRef, useEffect } from 'react'\nimport Tests from '../components/Tests'\nimport MicroApp from '@workgrid/micro-app'\nimport './summary.css'\n\nconst Summary = () => {\n  const microapp = useRef(\n    new MicroApp({\n      id: 'edge-microapp',\n      audience: 'edge-microapp'\n    })\n  )\n\n  useEffect(() => {\n    console.log('Initialize')\n    microapp.current.initialize()\n  }, [])\n\n  const showDetail = detailPage => {\n    // We have to use the hash router to show detail due to Github pages limitations\n    console.log('Showing detail')\n    microapp.current.showDetail({\n      url: `${window.location.origin}${window.location.pathname}#/${detailPage}`,\n      title: 'Edge Microapp'\n    })\n  }\n\n  return (\n    <div>\n      <h1>Edge Microapp</h1>\n      <p>This is the \"edgy\" microapp.</p>\n      <section className=\"section\">\n        <input type=\"text\" placeholder=\"Input Test\"></input>\n        <Tests microapp={microapp.current} />\n      </section>\n      <div className=\"action-block vertical\">\n        <button className=\"secondary\" onClick={() => showDetail('iframe')}>\n          Inner iFrame\n        </button>\n        <button className=\"primary\" onClick={() => showDetail('tests')}>\n          Detail Tests\n        </button>\n        {/* <button className=\"primary\" onClick={() => showDetail('featurepolicy')}>\n          Feature Policy\n        </button> */}\n      </div>\n    </div>\n  )\n}\n\nexport default Summary\n","import React, { useRef, useEffect, useState } from 'react'\nimport MicroApp from '@workgrid/micro-app'\nimport './detail.css'\n\nconst Detail = () => {\n  const microapp = useRef(\n    new MicroApp({\n      id: 'edge-microapp',\n      audience: 'edge-microapp'\n    })\n  )\n\n  const [currentCount, setCurrentCount] = useState(5)\n  const [iframeUrl, setIframeUrl] = useState('')\n  const countdownTimer = useRef()\n\n  useEffect(() => {\n    console.log('Initializing Detail')\n    microapp.current.initialize()\n    countdownTimer.current = setInterval(() => {\n      setCurrentCount(prev => {\n        console.log(!!(prev % 2) ? 'Tick' : 'Tock')\n        return prev - 1\n      })\n    }, 1000)\n  }, [])\n\n  useEffect(() => {\n    if (currentCount <= 0) {\n      setIframeUrl('https://www.catapultsgame.com/app/')\n      clearInterval(countdownTimer.current)\n    }\n  }, [currentCount])\n\n  return (\n    <div className=\"container\">\n      <h1>IFrame Detail</h1>\n      <p>Tests an inner iFrame. This is a typical use case for \"wrapping\" an existing app in a MicroApp.</p>\n      <div className=\"example-block\">\n        <p>Showing iFrame in {currentCount}s</p>\n        <iframe style={{ width: '100%', borderWidth: 1 }} title=\"Example Iframe\" src={iframeUrl} />\n      </div>\n    </div>\n  )\n}\n\nexport default Detail\n","import React, { useRef, useEffect } from 'react'\nimport MicroApp from '@workgrid/micro-app'\nimport './detail.css'\nimport Tests from '../components/Tests'\n\nconst Detail = () => {\n  const microapp = useRef(\n    new MicroApp({\n      id: 'edge-microapp',\n      audience: 'edge-microapp'\n    })\n  )\n\n  useEffect(() => {\n    console.log('Initializing Detail')\n    microapp.current.initialize()\n  }, [])\n\n  return (\n    <div className=\"container\">\n      <h1>Tests Detail</h1>\n      <div className=\"example-block\">\n        <Tests microapp={microapp.current} />\n      </div>\n    </div>\n  )\n}\n\nexport default Detail\n","import React from 'react'\nimport { HashRouter as Router, Route } from 'react-router-dom'\n\nimport Summary from './pages/Summary'\nimport IFrameDetail from './pages/IFrameDetail'\n// import FeaturePolicyDetail from './pages/FeaturePolicyDetail'\nimport TestDetail from './pages/TestDetail'\n\nconst App = () => {\n  return (\n    <Router basename={window.location.pathname}>\n      <Route path=\"/\" exact component={Summary} />\n      <Route path=\"/tests\" component={TestDetail} />\n      <Route path=\"/iframe\" component={IFrameDetail} />\n      {/* <Route path=\"/featurepolicy\" component={FeaturePolicyDetail} /> */}\n    </Router>\n  )\n}\n\nexport default App\n","import 'core-js/stable'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","(function (factory) {\n  if (typeof module === \"object\" && typeof module.exports === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"tslib\", \"ms\", \"./queue\", \"@workgrid/courier\", \"jwt-decode\", \"lodash\", \"resize-observer-polyfill\", \"p-any\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  exports.__esModule = true;\n\n  var tslib_1 = require(\"tslib\");\n\n  var ms_1 = tslib_1.__importDefault(require(\"ms\"));\n\n  var queue_1 = tslib_1.__importDefault(require(\"./queue\"));\n\n  var courier_1 = tslib_1.__importDefault(require(\"@workgrid/courier\"));\n\n  var jwt_decode_1 = tslib_1.__importDefault(require(\"jwt-decode\"));\n\n  var lodash_1 = require(\"lodash\");\n\n  var resize_observer_polyfill_1 = tslib_1.__importDefault(require(\"resize-observer-polyfill\"));\n\n  var p_any_1 = tslib_1.__importDefault(require(\"p-any\"));\n\n  var EVENTS = {\n    READY: 'ready',\n    ERROR: 'error',\n    SET_SIZE: 'setSize',\n    SHOW_DETAIL: 'showDetail',\n    HIDE_DETAIL: 'hideDetail',\n    UPDATE_TITLE: 'updateTitle',\n    REFRESH_TOKEN: 'refreshToken'\n  };\n  var READY_TIMEOUT = ms_1[\"default\"]('10s');\n  var READY_INTERVAL = ms_1[\"default\"]('100ms');\n\n  var isExpired = function isExpired(token) {\n    try {\n      var decoded = jwt_decode_1[\"default\"](token);\n      return decoded.exp < Date.now() / 1000;\n    } catch (e) {\n      return true;\n    }\n  };\n  /**\n   * Create a new instance of the Micro App library.\n   *\n   * @beta\n   */\n\n\n  var MicroApp =\n  /** @class */\n  function () {\n    function MicroApp(_a) {\n      var _this = this;\n\n      var audience = _a.audience,\n          onError = _a.onError,\n          id = _a.id;\n      /**\n       * Set up the communication channel with Workgrid.\n       * A loading overlay will be displayed until `initialize` is invoked.\n       */\n\n      this.initialize = function () {\n        // Tell the host we're ready\n        _this.ready().then(function () {\n          // Flush the queue\n          _this.queue.flush(); // Listen for resize\n\n\n          _this.subscribe();\n        });\n      };\n      /**\n       * Start the resize observer\n       */\n\n\n      this.subscribe = function () {\n        _this.ro.observe(window.document.documentElement);\n\n        return _this.unsubscribe; // why not... lol\n      };\n      /**\n       * Stop the resize observer\n       */\n\n\n      this.unsubscribe = function () {\n        _this.ro.disconnect();\n      };\n      /**\n       * Set the current height on resize\n       */\n\n\n      this.handleResize = lodash_1.throttle(function (entries) {\n        var mainElement = entries[0].target;\n        var height = mainElement.offsetHeight;\n\n        _this.emit({\n          type: EVENTS.SET_SIZE,\n          payload: {\n            height: height\n          }\n        });\n      }, 1000);\n      /**\n       * Retrieve a token to validate the user in your API.\n       * The token will be a JWT that includes `email`, `workgrid_space_id` and `workgrid_tenant_id`.\n       */\n\n      this.getToken = function () {\n        return tslib_1.__awaiter(_this, void 0, void 0, function () {\n          var _a;\n\n          return tslib_1.__generator(this, function (_b) {\n            switch (_b.label) {\n              case 0:\n                if (this.token && !isExpired(this.token)) return [2\n                /*return*/\n                , this.token];\n                _a = this;\n                return [4\n                /*yield*/\n                , this.send({\n                  type: EVENTS.REFRESH_TOKEN,\n                  payload: {\n                    audience: this.audience\n                  }\n                })];\n\n              case 1:\n                return [2\n                /*return*/\n                , _a.token = _b.sent()];\n            }\n          });\n        });\n      };\n      /**\n       * Update the title of the detail panel. This will let you reflect\n       */\n\n\n      this.updateTitle = function (title) {\n        _this.emit({\n          type: EVENTS.UPDATE_TITLE,\n          payload: {\n            title: title\n          }\n        });\n      };\n      /**\n       * Show the detail with the given url and optional title.\n       * The page shown must also be configured as a micro app, otherwise an error will be thrown.\n       */\n\n\n      this.showDetail = function (_a) {\n        var url = _a.url,\n            title = _a.title;\n        if (!url) throw new Error('URL is required to show details');\n\n        _this.send({\n          type: EVENTS.SHOW_DETAIL,\n          payload: {\n            title: title,\n            url: url\n          }\n        });\n      };\n      /**\n       * Hide the detail if it's visible.\n       */\n\n\n      this.hideDetail = function () {\n        _this.send({\n          type: EVENTS.HIDE_DETAIL\n        });\n      }; // Private API\n\n      /**\n       * Wrap the event emitter in a queue that is flushed when the host is ready.\n       */\n\n\n      this.emit = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        _this.queue.push(function () {\n          var _a;\n\n          (_a = _this.courier).emit.apply(_a, tslib_1.__spread(args));\n        });\n      };\n      /**\n       * Wrap the event sender in a queue that is flushed when the host is ready.\n       */\n\n\n      this.send = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return new Promise(function (resolve, reject) {\n          _this.queue.push(function () {\n            var _a;\n\n            (_a = _this.courier).send.apply(_a, tslib_1.__spread(args)).then(resolve, reject);\n          });\n        });\n      };\n      /**\n       * Tell the host we're ready every 100ms until the message is acknowledged.\n       * The event will be attempted 100 times (about 10s) before rejecting.\n       */\n\n\n      this.ready = function (attempt) {\n        if (attempt === void 0) {\n          attempt = 1;\n        }\n\n        var payload = {\n          height: window.document.documentElement.offsetHeight\n        };\n        var sendPromises = [_this.courier.send({\n          type: EVENTS.READY,\n          payload: payload\n        })];\n        var interval = setInterval(function () {\n          sendPromises.push(_this.courier.send({\n            type: EVENTS.READY,\n            payload: payload\n          }));\n          attempt++; // create a new promise every 100ms for 10s\n\n          if (attempt >= READY_TIMEOUT / READY_INTERVAL) {\n            clearInterval(interval);\n          }\n        }, READY_INTERVAL);\n        return p_any_1[\"default\"](sendPromises).then(function () {\n          return clearInterval(interval);\n        });\n      };\n\n      if (!audience) throw new Error('Missing required parameter: options.audience');\n      this.audience = audience;\n      this.id = id || audience;\n\n      var noop = function noop() {};\n\n      this.courier = new courier_1[\"default\"]({\n        id: this.id\n      });\n      this.courier.on('error', onError || noop);\n      this.queue = queue_1[\"default\"]();\n      this.ro = new resize_observer_polyfill_1[\"default\"](this.handleResize);\n    }\n\n    return MicroApp;\n  }();\n\n  exports[\"default\"] = MicroApp;\n});"],"sourceRoot":""}